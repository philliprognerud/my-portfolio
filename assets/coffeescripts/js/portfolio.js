// Generated by CoffeeScript 1.12.6
(function() {
  $(document).ready(function() {
    return $("html,body").animate({
      scrollTop: 0
    }, 100);
  });
  alert("TEST");
  codeLevels = {
    "Python": "85%",
    "Javascript": "70%",
    "Java": "50%",
    "C": "45%",
    "PHP": "20%",
    "HTML+CSS": "90%"
  }

//setting page back to defaults
  $("body").css({"animation": "fadeOut-color 0.4s ease-in-out forwards" });
  $(".container").css({"color":"black"});

//disable scrolling until animations are done
  $("body").addClass("stop-scrolling");
  setTimeout(function(){
    $("body").removeClass("stop-scrolling");
  },4100);

var clickCount = 0;
//if box clicked then execute animation/css changes
  $(".box").on("click", function(){
    var boxes = document.querySelectorAll(".box");
    var parent = this;

    boxes.forEach(function(box, index){
      if(parent.innerText === box.innerText){
        if(clickCount%2 === 0){
          parent.style.cssText= "height:400px;transition: height 0.2s linear 0.8s;";
          setTimeout(function(){
            parent.querySelector(".text").style.cssText = "display: inline-block;animation: fadeIn 0.8s linear;";
            parent.querySelector("span").classList.remove("fa-expand");
            parent.querySelector("span").classList.add("fa-compress");
            clickCount += 1;
          }, 1100);

          //if box languages has been clicked
          if(parent.querySelector("p").innerHTML === "Languages"){
            var languages = parent.querySelectorAll("#progress li");
            var progress = parent.querySelectorAll(".meter > span");

            //delay to fade in unordered list
            setTimeout(function(){
              parent.querySelector("#progress").style.cssText = "display:table-row;animation: fadeIn 0.5s ease-in-out forwards;";
            }, 1300);

            //delay for progress bar transition effect
            setTimeout(function(){
              languages.forEach(function(language, index){
                var key = language.querySelector(".language").innerHTML;
                var lang = codeLevels[key];
                progress[index].style.cssText= "width: " + lang + "; transition: width 0.4s linear;";
              });
            }, 1800);
          }

          slideOut(index, boxes);
          setTimeout(function(){
            parent.style.marginTop = "90px";
          },690);
        } else {
          slideIn(index, boxes);
          parent.style.cssText= "height:90px;transition: height 0.15s linear;";
          parent.querySelector(".text").style.cssText = "animation: fadeOut 0.5s linear;";
          parent.querySelector("span").classList.remove("fa-compress");
          parent.querySelector("span").classList.add("fa-expand");
          clickCount += 1;

          //reset progress bars to 0% and fade out
          if(parent.querySelector("p").innerHTML === "Languages"){
            var progress = parent.querySelectorAll(".meter > span");
            parent.querySelector("#progress").style.cssText = "display:none;opacity:0;";
            progress.forEach(function(item){
              item.style.cssText= "width: 0%;";
            })
          }
        }
      }
    });
  });

  function slideIn(i, boxes) {
    boxes.forEach(function(box, index){
      if(index !== i){
        boxes[index].style.cssText = "display:block;opacity:0";
        setTimeout(function(){
          boxes[index].style.cssText = "animation:slideRightIn 0.75s ease-in-out forwards;";
        },100)
      }
    });
  }

  function slideOut(i, boxes){
    boxes.forEach(function(box, index){
      if(index !== i){
        setTimeout(function(){
          boxes[index].style.cssText = "display:none;";
        }, 700);

        if(index%2 === 0){
          boxes[index].style.cssText = "animation:slideLeft 0.75s ease-in-out forwards;";
        } else {
          boxes[index].style.cssText = "animation:slideRight 0.75s ease-in-out forwards;";
        }

      }
    });
  }

  //dynamically changes bottom height depending on size of window
  window.onresize = function(event) {
    var containerOffset =   document.querySelector(".container").getBoundingClientRect().top;
    var height = window.innerHeight - containerOffset - $(".picBorder").height() - 30;
    $(".bottom").css({"height": height});
  };

  //fades out the body when scrolling up.
  var fromBottom = false;
  window.onscroll = function(e) {
    //IMPORTANT REMEMBER THIS FUNCTION !!~~~~
    var offset = document.querySelector(".bottom").getBoundingClientRect().top;

    if(offset < 600){
      $("hr").css({"animation": "fadeOut 0.4s ease-in-out forwards"});
      $(".about").css({"animation": "fadeOut 0.4s ease-in-out forwards"});
      fromBottom = true;
    } else if(fromBottom){
      $("hr").css({"animation": "fadeIn 0.4s ease-in-out forwards"});
      $(".about").css({"animation": "fadeIn 0.4s ease-in-out forwards"});
      fromBottom = false;
    }
  };

}).call(this);
