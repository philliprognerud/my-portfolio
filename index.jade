//output:index.html, pretty:true

head
  title Portfolio
  link(rel="stylesheet" href="./scss/css/portfolio.css" type="text/css")
  link(rel="stylesheet" href="https://fonts.googleapis.com/css?family=Oxygen")
  script(type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.js")
  script(type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.10/handlebars.js")
  script(type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/paper.js/0.11.4/paper-full.js")
  script(type="text/paperscript" canvas="myCanvas").
    //paperscript cannot be used in external .js
    var shapes = [];
    var i = 0;

    function onKeyDown(event){
      loop();
    }
    
    function loop(){
      setTimeout(function(){
          var randomSize= Math.floor(Math.random() * 40) + 10;
          var height = view.size.height - 300;
          var maxPoint = new Point(-40, height);
          var randomPoint = Point.random() + 0.35;
          var point = maxPoint * randomPoint;
          var newShape = new Path.Rectangle(new Point(point), randomSize);
          newShape.rasterize(300);
          newShape.strokeColor = 'rgb(' + (Math.floor(Math.random() * 256)) + ',' + (Math.floor(Math.random() * 256)) + ',' + (Math.floor(Math.random() * 256)) + ')';
          shapes.push(newShape);
          i++;
          if(i < 80){
            loop();
          }
        }, 500)
    };

    function onFrame(event) {
      for(var i = 0; i < shapes.length; i++){
        shapes[i].rotate(1);
        shapes[i].strokeColor.hue += 1;
        shapes[i].position.x += shapes[i].bounds.width / 40;
        if(shapes[i].bounds.left > view.size.width){
          shapes[i].position.x = -shapes[i].bounds.width;
        }
      }
    }
    
body
  .border
  .overlay
    .container(resize='')
      script(id="some-template" type="text/x-handlebars-template").
        <h1>
          {{#users}}
            {{firstName}} {{lastName}}
          {{/users}}
        <h1>
  canvas(id="myCanvas", resize="")

  script(src="./coffeescripts/js/portfolio.js")
